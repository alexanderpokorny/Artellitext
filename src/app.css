/* ===========================================
   ARTELLICO - Global Stylesheet
   Cognitive Sovereignty Design System
   
   IMPORTANT: Critical CSS (fonts, base colors, font-sizes)
   are defined in app.html inline styles to prevent FOUC.
   This file contains ONLY non-critical styles.
   
   DO NOT REDEFINE HERE:
   - @font-face declarations
   - --font-human, --font-machine variables
   - --font-size-base
   - --color-bg, --color-text (base theme colors)
   - html/body font-family, font-size, color, background
   =========================================== */

/* ===========================================
   EXTENDED THEME COLOR VARIABLES
   
   Base colors are in app.html critical CSS.
   These are additional colors needed by components.
   =========================================== */

:root {
	/* -----------------------------------------
	   LIGHT MODE - Extended Colors
	   (Base colors --color-bg, --color-text etc 
	    are in app.html critical CSS)
	   ----------------------------------------- */
	
	/* Additional Background Colors */
	--color-bg-sunken: #e8e8e8;
	--color-bg-hover: #e0e0e0;
	--color-bg-overlay: rgba(0, 0, 0, 0.5);
	
	/* Additional Border Colors */
	--color-border-strong: #b0b0b0;
	--color-border-subtle: #e0e0e0;
	
	/* Inverse Text (for dark backgrounds) */
	--color-text-inverse: #fafafa;
	
	/* Accent Colors */
	--color-accent: #1a1a1a;
	--color-accent-hover: #4a4a4a;
	
	/* Link/Active Colors - Cobalt Blue (from Ghost theme) */
	--color-link: #1d4ed8;
	--color-link-hover: #1e40af;
	--color-active: #1d4ed8;
}

html.dark {
	/* -----------------------------------------
	   DARK MODE - Extended Colors
	   ----------------------------------------- */
	
	/* Additional Background Colors */
	--color-bg-sunken: #0a0a0a;
	--color-bg-hover: #2a2a2a;
	--color-bg-overlay: rgba(0, 0, 0, 0.7);
	
	/* Additional Border Colors */
	--color-border-strong: #525252;
	--color-border-subtle: #262626;
	
	/* Inverse Text */
	--color-text-inverse: #1a1a1a;
	
	/* Accent Colors */
	--color-accent: #fafafa;
	--color-accent-hover: #a3a3a3;
	
	/* Link/Active Colors - Light Blue for dark mode (from Ghost theme) */
	--color-link: #93c5fd;
	--color-link-hover: #bfdbfe;
	--color-active: #93c5fd;
}

html.high-contrast {
	/* -----------------------------------------
	   HIGH CONTRAST MODE - WCAG AAA / E-Ink
	   Maximum contrast for accessibility and
	   e-ink displays (reMarkable, Kindle, etc.)
	   ----------------------------------------- */
	
	/* All backgrounds pure white */
	--color-bg-sunken: #ffffff;
	--color-bg-hover: #f0f0f0;
	--color-bg-overlay: rgba(255, 255, 255, 0.95);
	
	/* All borders black for maximum visibility */
	--color-border-strong: #000000;
	--color-border-subtle: #000000;
	
	/* Text always black */
	--color-text-inverse: #ffffff;
	
	/* Accent = black */
	--color-accent: #000000;
	--color-accent-hover: #333333;
	
	/* Link/Active = black (underlined for distinction) */
	--color-link: #000000;
	--color-link-hover: #000000;
	--color-active: #000000;
}

/* ===========================================
   NON-THEME DESIGN TOKENS
   (These don't change between light/dark)
   
   Note: --font-human, --font-machine, --font-size-base
   are defined in app.html critical CSS
   =========================================== */

:root {
	/* -----------------------------------------
	   TYPOGRAPHY - Extended
	   (Base font variables in app.html)
	   ----------------------------------------- */
	--font-typewriter: var(--font-machine);
	
	/* Font Sizes - Extended (base is in app.html) */
	--font-size-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
	--font-size-sm: clamp(0.875rem, 0.8rem + 0.35vw, 1rem);
	--font-size-lg: clamp(1.125rem, 1rem + 0.6vw, 1.25rem);
	--font-size-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
	--font-size-2xl: clamp(1.5rem, 1.25rem + 1.25vw, 2rem);
	--font-size-3xl: clamp(2rem, 1.5rem + 2.5vw, 3rem);
	
	/* Line Heights */
	--line-height-tight: 1.2;
	--line-height-base: 1.5;
	--line-height-relaxed: 1.75;
	
	/* Letter Spacing */
	--tracking-wide: 0.025em;
	--tracking-wider: 0.05em;
	
	/* -----------------------------------------
	   SPACING
	   ----------------------------------------- */
	--space-1: 0.25rem;   /* 4px */
	--space-2: 0.5rem;    /* 8px */
	--space-3: 0.75rem;   /* 12px */
	--space-4: 1rem;      /* 16px */
	--space-5: 1.25rem;   /* 20px */
	--space-6: 1.5rem;    /* 24px */
	--space-8: 2rem;      /* 32px */
	--space-9: 2.25rem;   /* 36px - 50% mehr als space-6 */
	--space-10: 2.5rem;   /* 40px */
	--space-12: 3rem;     /* 48px */
	--space-16: 4rem;     /* 64px */
	
	/* -----------------------------------------
	   LAYOUT DIMENSIONS
	   ----------------------------------------- */
	--sidebar-width: 260px;
	--header-height: 60px;
	--footer-height: 38px;
	--status-bar-height: 38px;
	--content-max-width: 720px;
	--site-padding: clamp(1rem, 3vw, 2rem);
	
	/* Editor Layout */
	--margin-column-width: 180px;
	--tag-column-width: 200px;
	
	/* Border Radius (from Ghost theme - subtle, not rounded) */
	--radius-sm: 3px;
	--radius-md: 4px;
	--radius-lg: 6px;
	--radius-full: 9999px;
	
	/* -----------------------------------------
	   TRANSITIONS
	   ----------------------------------------- */
	--transition-fast: 100ms ease-out;
	--transition-base: 200ms ease-out;
	--transition-slow: 300ms ease-out;
	
	/* -----------------------------------------
	   Z-INDEX
	   ----------------------------------------- */
	--z-base: 0;
	--z-dropdown: 100;
	--z-sticky: 200;
	--z-fixed: 300;
	--z-modal: 500;
	--z-tooltip: 700;
	
	/* -----------------------------------------
	   STATUS COLORS (same for both themes)
	   ----------------------------------------- */
	--color-success: #16a34a;
	--color-warning: #ca8a04;
	--color-error: #dc2626;
	--color-info: #2563eb;
}

/* ===========================================
   BASE STYLES - EXTENSIONS ONLY
   
   CRITICAL: Base styles for html, body, box-sizing
   are in app.html inline CSS. Do NOT redefine here.
   Only add styles that don't affect initial render.
   =========================================== */

/* ===========================================
   MAIN APPLICATION LAYOUT - CSS Grid
   
   Modern "App Shell" Layout using CSS Grid.
   Grid Template Areas for pixel-perfect alignment.
   
   Structure (3 rows × 2 columns):
   ┌─────────────────┬─────────────────────────┐
   │ sidebar-header  │ main-header             │  Row 1: 60px
   ├─────────────────┼─────────────────────────┤
   │ sidebar-nav     │ main-content            │  Row 2: 1fr
   ├─────────────────┼─────────────────────────┤
   │ sidebar-footer  │ main-footer             │  Row 3: 40px
   └─────────────────┴─────────────────────────┘
     Col 1: 260px      Col 2: 1fr
   =========================================== */

.app-layout {
	display: grid;
	height: 100vh;
	width: 100vw;
	overflow: hidden;
	background: var(--color-bg);
	
	/* Grid Definition */
	grid-template-columns: var(--sidebar-width) 1fr;
	grid-template-rows: var(--header-height) 1fr var(--footer-height);
	
	/* Named Grid Areas */
	grid-template-areas: 
		"sidebar-header  main-header"
		"sidebar-nav     main-content"
		"sidebar-footer  main-footer";
}

/* -----------------------------------------
   SIDEBAR HEADER (Grid Area: sidebar-header)
   ----------------------------------------- */

.sidebar-header {
	grid-area: sidebar-header;
	display: flex;
	align-items: center;
	gap: var(--space-3);
	padding: 0 var(--space-4);
	padding-left: calc(var(--space-4) + 10px);
	background: var(--color-bg-sidebar);
	border-right: 1px solid var(--color-border);
	border-bottom: 1px solid var(--color-border);
}

.sidebar-logo {
	height: 32px;
	width: auto;
}

/* Logo visibility based on theme */
.logo-light {
	display: block;
}

.logo-dark {
	display: none;
}

html.dark .logo-light {
	display: none;
}

html.dark .logo-dark {
	display: block;
}

.sidebar-title {
	font-family: var(--font-machine);
	font-size: calc(var(--font-size-sm) * 1.2);
	font-weight: 700;
	letter-spacing: 0.1em;
	color: var(--color-text);
	margin: 0;
}

/* -----------------------------------------
   MAIN HEADER (Grid Area: main-header)
   ----------------------------------------- */

.main-header {
	grid-area: main-header;
	display: flex;
	align-items: center;
	gap: var(--space-4);
	padding: 0 var(--space-6);
	background: var(--color-bg-sidebar);  /* Same as sidebar, not elevated */
	border-bottom: 1px solid var(--color-border);
}

/* -----------------------------------------
   SIDEBAR NAV (Grid Area: sidebar-nav)
   ----------------------------------------- */

.sidebar-nav {
	grid-area: sidebar-nav;
	background: var(--color-bg-sidebar);
	border-right: 1px solid var(--color-border);
	overflow-y: auto;
}

.nav-container {
	display: flex;
	flex-direction: column;
	height: 100%;
	padding: var(--space-4);
}

.nav-spacer {
	flex: 1;
}

.nav-list-bottom {
	margin-top: auto;
	padding-top: var(--space-3);
}

.nav-list-bottom.has-user {
	border-top: 1px solid var(--color-border);
}

/* -----------------------------------------
   MAIN CONTENT (Grid Area: main-content)
   Abstand zum Rand: 50% größer als vorher
   ----------------------------------------- */

.main-content {
	grid-area: main-content;
	overflow-y: auto;
	overflow-x: hidden;
	padding: var(--space-9);  /* 36px */
	background: var(--color-bg);
}

/* Vertikale Abstände zwischen Content-Blöcken verdoppeln */
.main-content > * + * {
	margin-top: var(--space-12);
}

/* -----------------------------------------
   SIDEBAR FOOTER (Grid Area: sidebar-footer)
   ----------------------------------------- */

.sidebar-footer {
	grid-area: sidebar-footer;
	display: flex;
	align-items: center;
	justify-content: flex-start;
	padding: 0 var(--space-4);
	padding-left: calc(var(--space-4) + 10px);
	background: var(--color-bg-sidebar);
	border-right: 1px solid var(--color-border);
	border-top: 1px solid var(--color-border);
}

.sidebar-copyright {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	margin: 0;
}

/* -----------------------------------------
   MAIN FOOTER (Grid Area: main-footer)
   ----------------------------------------- */

.main-footer {
	grid-area: main-footer;
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: var(--space-2) var(--space-6) var(--space-3);
	background: var(--color-bg-sidebar);  /* Same as sidebar, not elevated */
	border-top: 1px solid var(--color-border);
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
}

.footer-stats {
	display: flex;
	align-items: center;
	gap: var(--space-2);
}

.footer-stat {
	letter-spacing: var(--tracking-wide);
}

.footer-divider {
	color: var(--color-border-strong);
}

/* ===========================================
   NAVIGATION STYLES
   =========================================== */

.nav-list {
	list-style: none;
	padding: 0;
	margin: 0;
	display: flex;
	flex-direction: column;
	gap: var(--space-1);
}

.nav-item {
	display: flex;
	align-items: center;
	gap: var(--space-3);
	padding: var(--space-3);
	border-radius: var(--radius-sm);
	color: var(--color-text-secondary);
	text-decoration: none;
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	letter-spacing: var(--tracking-wider);
	text-transform: uppercase;
	transition: all var(--transition-fast);
	cursor: pointer;
	background: transparent;
	border: none;
	width: 100%;
	text-align: left;
}

.nav-item:hover {
	color: var(--color-text);
	background: var(--color-bg-hover);
	text-decoration: none;
}

.nav-item.active {
	color: var(--color-active);
	font-weight: 700;
	background: var(--color-bg-hover);
}

.nav-icon {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 20px;
	height: 20px;
	flex-shrink: 0;
}

.nav-icon svg {
	width: 100%;
	height: 100%;
}

.nav-label {
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}

.nav-section-title {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	text-transform: uppercase;
	letter-spacing: var(--tracking-wider);
	padding: var(--space-2) var(--space-3);
	margin-top: var(--space-4);
}

/* ===========================================
   SEARCH BAR
   =========================================== */

.search-bar {
	display: flex;
	align-items: center;
	gap: var(--space-2);
	flex: 1;
	max-width: 480px;
	padding: var(--space-2) var(--space-1);
	background: transparent;
	border: none;
	border-bottom: 1px solid transparent;
	border-radius: 0;
	transition: border-color var(--transition-fast);
}

.search-bar:focus-within {
	background: transparent;
	border-bottom-color: var(--color-border);
}

.search-icon {
	width: 18px;
	height: 18px;
	color: var(--color-text-muted);
	flex-shrink: 0;
}

.search-input {
	flex: 1;
	min-width: 0;
	padding: 0;
	font-family: var(--font-machine);
	font-size: var(--font-size-sm);
	text-transform: uppercase;
	letter-spacing: var(--tracking-wider);
	color: var(--color-text);
	background: transparent;
	border: none;
	outline: none;
	box-shadow: none;
	-webkit-appearance: none;
	-moz-appearance: none;
	appearance: none;
}

.search-input:focus {
	outline: none;
	box-shadow: none;
}

.search-input::placeholder {
	color: var(--color-text-muted);
	text-transform: uppercase;
	font-family: var(--font-machine);
	letter-spacing: var(--tracking-wider);
}

/* Remove browser search input styling */
.search-input::-webkit-search-decoration,
.search-input::-webkit-search-cancel-button,
.search-input::-webkit-search-results-button,
.search-input::-webkit-search-results-decoration {
	-webkit-appearance: none;
}

/* ===========================================
   HEADER CONTROLS
   =========================================== */

.header-controls {
	display: flex;
	align-items: center;
	gap: var(--space-2);
	margin-left: auto;
}

/* ===========================================
   BUTTONS
   =========================================== */

.btn {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	gap: var(--space-2);
	padding: var(--space-2) var(--space-4);
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	letter-spacing: var(--tracking-wide);
	text-transform: uppercase;
	text-decoration: none;
	border-radius: var(--radius-sm);
	border: 1px solid transparent;
	cursor: pointer;
	transition: all var(--transition-fast);
}

.btn:hover {
	text-decoration: none;
}

.btn-primary {
	background: var(--color-accent);
	color: var(--color-text-inverse);
	border-color: var(--color-accent);
}

.btn-primary:hover {
	background: var(--color-accent-hover);
	border-color: var(--color-accent-hover);
}

.btn-ghost {
	background: transparent;
	color: var(--color-text-secondary);
	border-color: transparent;
}

.btn-ghost:hover {
	color: var(--color-text);
	background: var(--color-bg-sunken);
}

/* Active state for fullscreen button */
.fullscreen-btn.active {
	color: var(--color-active);
	background: var(--color-bg-sunken);
}

.fullscreen-btn.active:hover {
	color: var(--color-active);
	background: var(--color-bg-hover);
}

.btn-sm {
	padding: var(--space-1) var(--space-3);
}

/* ===========================================
   ICON BUTTONS (Theme Toggle, etc.)
   =========================================== */

.icon-btn {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 36px;
	height: 36px;
	padding: 0;
	background: transparent;
	border: none;
	border-radius: var(--radius-sm);
	color: var(--color-text-secondary);
	cursor: pointer;
	transition: all var(--transition-fast);
}

.icon-btn:hover {
	color: var(--color-text);
	background: var(--color-bg-sunken);
}

.icon-btn svg {
	width: 20px;
	height: 20px;
}

/* ===========================================
   USER AVATAR
   =========================================== */

.user-avatar {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 36px;
	height: 36px;
	border-radius: var(--radius-full);
	background: var(--color-bg-sunken);
	overflow: hidden;
	text-decoration: none;
}

.user-avatar:hover {
	opacity: 0.8;
}

.user-avatar img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.avatar-initial {
	font-family: var(--font-machine);
	font-size: var(--font-size-sm);
	color: var(--color-text-secondary);
}

/* ===========================================
   TYPOGRAPHY UTILITIES
   =========================================== */

.prose {
	font-family: var(--font-human);
	font-size: var(--font-size-base);
	line-height: var(--line-height-relaxed);
}

.interface {
	font-family: var(--font-machine);
	font-size: var(--font-size-sm);
	line-height: var(--line-height-base);
	letter-spacing: var(--tracking-wide);
}

/* ===========================================
   LINKS
   =========================================== */

a {
	color: inherit;
	text-decoration: none;
}

/* ===========================================
   IMAGES
   =========================================== */

img {
	max-width: 100%;
	height: auto;
	display: block;
}

/* ===========================================
   FORM ELEMENTS
   =========================================== */

input, textarea, select {
	font-family: inherit;
	font-size: inherit;
	color: inherit;
}

/* Text inputs with underline only */
.form-group {
	margin-bottom: var(--space-4);
}

.form-label {
	display: block;
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	letter-spacing: var(--tracking-wider);
	text-transform: uppercase;
	color: var(--color-text-secondary);
	margin-bottom: var(--space-2);
}

.form-input {
	width: 100%;
	padding: var(--space-3) 0;
	font-family: var(--font-human);
	font-size: var(--font-size-base);
	color: var(--color-text);
	background: transparent;
	border: none;
	border-bottom: 1px solid var(--color-border);
	border-radius: 0;
	transition: border-color var(--transition-fast);
	-webkit-appearance: none;
	appearance: none;
}

.form-input:focus {
	outline: none;
	border-bottom-color: var(--color-text);
}

.form-input::placeholder {
	color: var(--color-text-muted);
}

.form-hint {
	display: block;
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	margin-top: var(--space-1);
}

/* ===========================================
   RESPONSIVE UTILITIES
   =========================================== */

@media (max-width: 767px) {
	.hide-mobile {
		display: none !important;
	}
	
	/* Mobile: Single column layout */
	.app-layout {
		grid-template-columns: 1fr;
		grid-template-rows: var(--header-height) 1fr var(--footer-height);
		grid-template-areas: 
			"main-header"
			"main-content"
			"main-footer";
	}
	
	.main-header {
		padding: 0 var(--space-4);
	}
	
	.main-content {
		padding: var(--space-4);
	}
	
	.main-footer {
		padding: 0 var(--space-4);
	}
}

@media (min-width: 768px) {
	.show-mobile-only {
		display: none !important;
	}
}

/* ===========================================
   SCROLLBAR STYLING - Using browser defaults
   =========================================== */

/* Native scrollbars - no custom styling for consistency */

/* ===========================================
   SELECTION STYLING
   =========================================== */

::selection {
	background: var(--color-accent);
	color: var(--color-text-inverse);
}

/* ===========================================
   FOCUS STYLES
   =========================================== */

:focus-visible {
	outline: 2px solid var(--color-accent);
	outline-offset: 2px;
}

/* ===========================================
   PRINT STYLES
   =========================================== */

@media print {
	.sidebar-header,
	.sidebar-nav,
	.sidebar-footer,
	.main-header,
	.main-footer {
		display: none !important;
	}
	
	.app-layout {
		grid-template-columns: 1fr;
		grid-template-rows: 1fr;
		grid-template-areas: "main-content";
	}
	
	.main-content {
		padding: 0;
	}
}

/* ===========================================
   DASHBOARD PAGE STYLES
   =========================================== */

.dashboard {
	max-width: var(--content-wide-max-width);
	margin: 0 auto;
}

/* Dashboard Header with inline stats */
.dashboard-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-bottom: var(--space-6);
	padding-bottom: var(--space-4);
	border-bottom: 1px solid var(--color-border);
}

.dashboard-header h1 {
	font-family: var(--font-machine);
	font-size: var(--font-size-lg);
	font-weight: 600;
	letter-spacing: var(--tracking-wider);
	text-transform: uppercase;
	color: var(--color-text);
	margin: 0;
}

.header-stats {
	display: flex;
	align-items: center;
	gap: var(--space-6);
}

.header-stat {
	display: flex;
	align-items: baseline;
	gap: var(--space-2);
}

.header-stat-value {
	font-family: var(--font-machine);
	font-size: var(--font-size-lg);
	font-weight: 600;
	color: var(--color-text);
}

.header-stat-label {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	letter-spacing: var(--tracking-wider);
	text-transform: uppercase;
	color: var(--color-text-muted);
}

/* Section titles */
.section-title {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	font-weight: 600;
	letter-spacing: var(--tracking-wider);
	text-transform: uppercase;
	color: var(--color-text-secondary);
	margin-bottom: var(--space-4);
}

/* Notes Section with view controls */
.notes-section {
	margin-bottom: var(--space-16);
}

.notes-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-bottom: var(--space-4);
	flex-wrap: wrap;
	gap: var(--space-3);
}

.notes-controls {
	display: flex;
	align-items: center;
	gap: var(--space-4);
}

.sort-controls {
	display: flex;
	align-items: center;
	gap: var(--space-2);
}

.sort-btn {
	display: flex;
	align-items: center;
	gap: var(--space-1);
	padding: var(--space-2) var(--space-3);
	background: transparent;
	border: 1px solid transparent;
	border-radius: var(--radius-sm);
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	letter-spacing: var(--tracking-wide);
	text-transform: uppercase;
	color: var(--color-text-muted);
	cursor: pointer;
	transition: all var(--transition-fast);
}

.sort-btn:hover {
	color: var(--color-text);
}

.sort-btn.active {
	color: var(--color-text);
	background: var(--color-bg-elevated);
	border-color: var(--color-border);
}

.sort-arrow {
	font-size: var(--font-size-sm);
}

.view-controls {
	display: flex;
	align-items: center;
	gap: var(--space-1);
	padding: var(--space-1);
	background: var(--color-bg-sunken);
	border-radius: var(--radius-sm);
}

.view-btn {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 32px;
	height: 32px;
	padding: 0;
	background: transparent;
	border: none;
	border-radius: var(--radius-sm);
	color: var(--color-text-muted);
	cursor: pointer;
	transition: all var(--transition-fast);
}

.view-btn:hover {
	color: var(--color-text);
}

.view-btn.active {
	background: var(--color-bg-elevated);
	color: var(--color-text);
	box-shadow: var(--shadow-sm);
}

/* Notes Container - Grid and List views */
.notes-container {
	display: grid;
	gap: var(--space-4);
}

/* List view */
.notes-container.list-view {
	grid-template-columns: 1fr;
}

/* Small grid (4 columns on large screens) */
.notes-container.grid-small {
	grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
}

/* Large grid (2-3 columns) */
.notes-container.grid-large {
	grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
}

/* Expanded view (single column with more content) */
.notes-container.expanded-view {
	grid-template-columns: 1fr;
}

/* When editor is expanded in grid views, first card spans full width */
.notes-container.has-expanded-editor.grid-small,
.notes-container.has-expanded-editor.grid-large {
	grid-template-columns: 1fr;
}

.notes-container.has-expanded-editor.grid-small .note-card:not(.new-note-card),
.notes-container.has-expanded-editor.grid-large .note-card:not(.new-note-card) {
	display: none;
}

/* New Note Card (first card / inline editor) */
.note-card.new-note-card {
	background: var(--color-bg-elevated);
	border: 2px dashed var(--color-border);
	border-radius: var(--radius-md);
	padding: var(--space-4);
	min-height: 80px;
	transition: all var(--transition-fast);
	cursor: text;
}

.note-card.new-note-card:hover {
	border-color: var(--color-accent);
}

.note-card.new-note-card.active {
	border-style: solid;
	border-color: var(--color-accent);
}

/* Expanded new note card in grid views */
.note-card.new-note-card.expanded {
	grid-column: 1 / -1;
	min-height: 200px;
}

/* Quick edit editor inside new note card */
.new-note-card .quick-edit-editor {
	min-height: 60px;
	outline: none;
}

.new-note-card .quick-edit-placeholder {
	font-family: var(--font-human);
	font-size: var(--font-size-base);
	color: var(--color-text-muted);
	font-style: italic;
}

.new-note-card .quick-edit-loading {
	font-family: var(--font-machine);
	font-size: var(--font-size-sm);
	color: var(--color-text-muted);
}

.new-note-card .quick-edit-footer {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-top: var(--space-3);
	padding-top: var(--space-3);
	border-top: 1px solid var(--color-border);
}

/* Load more trigger */
.load-more-trigger {
	display: flex;
	align-items: center;
	justify-content: center;
	padding: var(--space-8);
	min-height: 60px;
}

.loading-spinner {
	width: 24px;
	height: 24px;
	border: 2px solid var(--color-border);
	border-top-color: var(--color-accent);
	border-radius: 50%;
	animation: spin 0.8s linear infinite;
}

@keyframes spin {
	to { transform: rotate(360deg); }
}

/* Recent Notes */
.recent-section {
	margin-bottom: var(--space-16);
}

.notes-list {
	display: flex;
	flex-direction: column;
	gap: var(--space-9);
}

.note-card {
	display: block;
	padding: var(--space-5) var(--space-6);
	background: var(--color-bg-elevated);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	text-decoration: none;
	transition: all var(--transition-fast);
	text-align: left;
	width: 100%;
	cursor: pointer;
}

.note-card:hover {
	border-color: var(--color-border-strong);
	transform: translateY(-1px);
	box-shadow: var(--shadow-sm);
}

/* Note card header with title and tags */
.note-card-header {
	display: flex;
	align-items: flex-start;
	justify-content: space-between;
	gap: var(--space-3);
	margin-bottom: var(--space-2);
}

.note-tags {
	display: flex;
	flex-wrap: wrap;
	gap: var(--space-1);
	flex-shrink: 0;
}

.note-tag {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	letter-spacing: var(--tracking-wide);
	padding: var(--space-1) var(--space-2);
	background: var(--color-bg-sunken);
	border-radius: var(--radius-sm);
	color: var(--color-text-muted);
}

.note-tag-more {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	padding: var(--space-1) var(--space-2);
}

/* Note card footer with metadata */
.note-card-footer {
	display: flex;
	align-items: center;
	gap: var(--space-4);
	margin-top: var(--space-3);
}

.note-words {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	letter-spacing: var(--tracking-wide);
}

/* Expanded note card */
.note-card.expanded {
	border-color: var(--color-accent);
}

.note-card.expanded .note-excerpt {
	-webkit-line-clamp: unset;
	line-clamp: unset;
}

/* Grid view specific styles */
.grid-small .note-card:not(.new-note-card) {
	min-height: 120px;
}

.grid-small .note-excerpt {
	-webkit-line-clamp: 3;
	line-clamp: 3;
}

.grid-large .note-card:not(.new-note-card) {
	min-height: 150px;
}

.grid-large .note-excerpt {
	-webkit-line-clamp: 4;
	line-clamp: 4;
}

/* List view specific styles */
.list-view .note-card {
	display: flex;
	align-items: center;
	gap: var(--space-4);
}

.list-view .note-card-header {
	flex: 1;
	margin-bottom: 0;
}

.list-view .note-excerpt {
	display: none;
}

.list-view .note-card-footer {
	margin-top: 0;
	flex-shrink: 0;
}

.note-title {
	font-family: var(--font-human);
	font-size: var(--font-size-lg);
	font-weight: 500;
	color: var(--color-text);
	margin-bottom: var(--space-2);
	line-height: var(--line-height-tight);
}

.note-excerpt {
	font-family: var(--font-human);
	font-size: var(--font-size-base);
	color: var(--color-text-secondary);
	line-height: var(--line-height-relaxed);
	margin-bottom: var(--space-3);
	display: -webkit-box;
	-webkit-line-clamp: 2;
	line-clamp: 2;
	-webkit-box-orient: vertical;
	overflow: hidden;
}

.note-time {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	letter-spacing: var(--tracking-wide);
}

/* Save indicator */
.save-indicator {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	letter-spacing: var(--tracking-wide);
	color: var(--color-text-muted);
	transition: color var(--transition-fast);
}

.save-indicator.saved {
	color: var(--color-success);
}

.save-indicator.saving {
	color: var(--color-warning);
}

@media (max-width: 767px) {
	.dashboard-header {
		flex-direction: column;
		align-items: flex-start;
		gap: var(--space-3);
	}
	
	.header-stats {
		gap: var(--space-4);
	}
	
	.notes-header {
		flex-direction: column;
		align-items: flex-start;
	}
	
	.notes-controls {
		width: 100%;
		justify-content: space-between;
	}
	
	.notes-container.grid-small,
	.notes-container.grid-large {
		grid-template-columns: 1fr;
	}
}

/* ===========================================
   AUTH LAYOUT STYLES (Minimal)
   =========================================== */

.auth-layout-minimal {
	min-height: 100vh;
	width: 100%;
	background: var(--color-bg);
}

/* ===========================================
   AUTH PAGE SPLIT LAYOUT
   =========================================== */

.auth-page-split {
	display: grid;
	grid-template-columns: 2fr 1fr;
	width: 100%;
	min-height: 100vh;
	position: relative;
}

/* Controls: Theme/Language in top-right corner */
.auth-controls {
	position: absolute;
	top: var(--space-4);
	right: var(--space-4);
	display: flex;
	align-items: center;
	gap: var(--space-3);
	z-index: 10;
}

/* Illustration Side */
.auth-illustration {
	display: flex;
	align-items: center;
	justify-content: center;
	padding: var(--space-12);
	background: var(--color-bg-sunken);
}

.illustration-container {
	position: relative;
	max-width: 500px;
	width: 100%;
}

.library-drawing {
	width: 100%;
	height: auto;
	color: var(--color-text-secondary);
	opacity: 0.8;
}

.illustration-quote {
	position: absolute;
	bottom: -var(--space-8);
	left: 50%;
	transform: translateX(-50%);
	text-align: center;
	width: 100%;
}

.illustration-quote p {
	font-family: var(--font-human);
	font-size: var(--font-size-lg);
	font-style: italic;
	line-height: var(--line-height-relaxed);
	color: var(--color-text-secondary);
	margin-bottom: var(--space-2);
}

.illustration-quote cite {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	font-style: normal;
	color: var(--color-text-muted);
	letter-spacing: var(--tracking-wider);
}

/* Form Side */
.auth-form-section {
	display: flex;
	align-items: center;
	justify-content: center;
	padding: var(--space-8);
}

.auth-form-container {
	max-width: 320px;
	width: 100%;
}

.auth-logo-wrapper {
	display: flex;
	justify-content: center;
	margin-bottom: var(--space-8);
}

.auth-logo {
	height: 40px;
	width: auto;
}

html.dark .auth-logo {
	filter: invert(1);
}

.auth-main-title {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	font-weight: 600;
	letter-spacing: var(--tracking-wider);
	text-transform: uppercase;
	color: var(--color-text-secondary);
	text-align: center;
	margin-bottom: var(--space-6);
}

/* OAuth Buttons */
.oauth-buttons {
	display: flex;
	gap: var(--space-3);
	margin-bottom: var(--space-6);
}

.oauth-btn {
	flex: 1;
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: var(--space-2);
	padding: var(--space-4);
	background: var(--color-bg-elevated);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	cursor: pointer;
	transition: all var(--transition-fast);
}

.oauth-btn:hover:not(:disabled) {
	border-color: var(--color-border-strong);
}

.oauth-btn:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

.oauth-icon {
	width: 20px;
	height: 20px;
	color: var(--color-text-secondary);
}

.oauth-btn span {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-secondary);
	letter-spacing: var(--tracking-wide);
}

/* Divider */
.auth-divider {
	display: flex;
	align-items: center;
	gap: var(--space-4);
	margin-bottom: var(--space-6);
}

.auth-divider::before,
.auth-divider::after {
	content: '';
	flex: 1;
	height: 1px;
	background: var(--color-border);
}

.auth-divider span {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	text-transform: lowercase;
}

/* Auth Form */
.auth-form {
	display: flex;
	flex-direction: column;
	gap: var(--space-5);
}

.auth-submit-btn {
	width: 100%;
	margin-top: var(--space-2);
}

/* Mode Switch */
.auth-mode-switch {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: var(--space-2);
	margin-top: var(--space-6);
	padding-top: var(--space-6);
	border-top: 1px solid var(--color-border);
}

.auth-mode-text {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
}

.auth-mode-btn {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	font-weight: 600;
	color: var(--color-text);
	background: none;
	border: none;
	padding: 0;
	cursor: pointer;
	text-decoration: underline;
	text-underline-offset: 3px;
}

.auth-mode-btn:hover {
	color: var(--color-accent);
}

/* Messages */
.auth-message {
	padding: var(--space-3) var(--space-4);
	border-radius: var(--radius-sm);
	font-family: var(--font-machine);
	font-size: var(--font-size-sm);
	margin-bottom: var(--space-4);
	text-align: center;
}

.auth-message-error {
	background: rgba(220, 38, 38, 0.1);
	border: 1px solid var(--color-error);
	color: var(--color-error);
}

.auth-message-success {
	background: rgba(22, 163, 74, 0.1);
	border: 1px solid var(--color-success);
	color: var(--color-success);
}

/* ===========================================
   FONT BASELINE ADJUSTMENTS
   Special Elite font sits slightly high, 
   needs 2px downward shift for visual alignment
   =========================================== */

.sidebar-title,
.section-title,
.stat-value,
.stat-label,
.action-label,
.note-time,
.nav-label,
.sidebar-copyright,
.status-indicator,
.doc-count,
.doc-author,
.doc-type,
.sort-select,
.btn,
[class*="font-machine"] {
	position: relative;
	top: 2px;
}

/* ===========================================
   HIGH CONTRAST MODE - Additional Styles
   =========================================== */

html.high-contrast .doc-type,
html.high-contrast .badge,
html.high-contrast .chip,
html.high-contrast .tag {
	border: 1px solid var(--color-border);
}

/* Responsive */
@media (max-width: 900px) {
	.auth-page-split {
		grid-template-columns: 1fr;
	}
	
	.auth-illustration {
		display: none;
	}
	
	.auth-form-section {
		padding: var(--space-6);
		min-height: 100vh;
	}
	
	.auth-controls {
		top: var(--space-3);
		right: var(--space-3);
	}
}

/* ===========================================
   EDITOR TOOLS - LaTeX / Math Block
   =========================================== */

.math-block {
	margin: var(--space-4) 0;
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	background: var(--color-bg-elevated);
	overflow: hidden;
}

.math-block[data-display-mode="true"] {
	padding: var(--space-4);
}

.math-block[data-display-mode="false"] {
	display: inline-block;
	padding: var(--space-2);
	margin: 0 var(--space-1);
	vertical-align: middle;
}

.math-input-container {
	padding: var(--space-3);
	background: var(--color-bg-sunken);
	border-bottom: 1px solid var(--color-border);
}

.math-input {
	width: 100%;
	min-height: 60px;
	padding: var(--space-2);
	font-family: var(--font-mono);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	resize: vertical;
}

.math-input:focus {
	outline: none;
	border-color: var(--color-link);
}

.math-preview {
	padding: var(--space-4);
	text-align: center;
	min-height: 40px;
	display: flex;
	align-items: center;
	justify-content: center;
}

.math-placeholder {
	color: var(--color-text-muted);
	font-style: italic;
}

.math-error {
	color: var(--color-error);
	font-size: var(--font-size-sm);
}

.math-controls {
	display: flex;
	gap: var(--space-2);
	padding: var(--space-2) var(--space-3);
	background: var(--color-bg-sunken);
	border-top: 1px solid var(--color-border);
}

.math-toggle {
	font-size: var(--font-size-xs);
	padding: var(--space-1) var(--space-2);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	cursor: pointer;
	color: var(--color-text);
}

.math-toggle:hover {
	background: var(--color-bg-hover);
}

/* Math close/insert button */
.math-close-btn {
	margin-left: auto;
	background: var(--color-success);
	color: var(--color-text-inverse);
	border-color: var(--color-success);
}

.math-close-btn:hover {
	background: #15803d;
}

/* Math delete button */
.math-delete-btn {
	color: var(--color-error);
	border-color: var(--color-error);
	background: transparent;
}

.math-delete-btn:hover {
	background: var(--color-error);
	color: var(--color-text-inverse);
}

/* Collapsed math block */
.math-block.math-collapsed {
	border: none;
	background: transparent;
}

.math-preview-collapsed {
	cursor: pointer;
	padding: var(--space-2);
	border-radius: var(--radius-sm);
	transition: background var(--transition-fast);
}

.math-preview-collapsed:hover {
	background: var(--color-bg-hover);
}

.equation-wrapper {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: var(--space-4);
}

.equation-number {
	color: var(--color-text-muted);
	font-size: var(--font-size-sm);
}

/* KaTeX overrides */
.katex {
	font-size: 1.1em;
}

.katex-display {
	margin: 0;
	overflow-x: auto;
	overflow-y: hidden;
}

/* Inline Math ($...$) */
.math-inline {
	display: inline;
	padding: 0 2px;
	vertical-align: baseline;
}

.math-inline .katex {
	font-size: 1em;
}

/* Display Math in Paragraph ($$...$$) */
.math-display {
	display: block;
	text-align: center;
	margin: var(--space-3) 0;
	overflow-x: auto;
}

.math-display .katex-display {
	margin: 0;
}

/* ===========================================
   EDITOR TOOLS - Mermaid Diagram Block
   =========================================== */

.mermaid-block {
	margin: var(--space-4) 0;
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	background: var(--color-bg-elevated);
	overflow: hidden;
}

.mermaid-split {
	display: grid;
	grid-template-columns: 1fr 1fr;
	gap: 1px;
	background: var(--color-border);
}

.mermaid-input-container,
.mermaid-preview-container {
	background: var(--color-bg);
	padding: var(--space-3);
}

.mermaid-label {
	display: block;
	font-size: var(--font-size-xs);
	color: var(--color-text-muted);
	text-transform: uppercase;
	letter-spacing: 0.05em;
	margin-bottom: var(--space-2);
}

.mermaid-input {
	width: 100%;
	min-height: 150px;
	padding: var(--space-2);
	font-family: var(--font-mono);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg-sunken);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	resize: vertical;
}

.mermaid-input:focus {
	outline: none;
	border-color: var(--color-link);
}

.mermaid-preview {
	min-height: 150px;
	display: flex;
	align-items: center;
	justify-content: center;
	background: var(--color-bg);
	border-radius: var(--radius-sm);
	overflow: auto;
}

.mermaid-preview svg {
	max-width: 100%;
	height: auto;
}

.mermaid-placeholder {
	color: var(--color-text-muted);
	font-style: italic;
}

.mermaid-error {
	color: var(--color-error);
	font-size: var(--font-size-sm);
	padding: var(--space-2);
}

/* ===========================================
   EDITOR TOOLS - Code Block with Syntax Highlighting
   =========================================== */

.code-block {
	margin: var(--space-3) 0;
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	background: var(--color-bg-elevated);
	overflow: hidden;
}

.code-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: var(--space-2) var(--space-3);
	background: var(--color-bg-sunken);
	border-bottom: 1px solid var(--color-border);
}

.code-language-select {
	font-family: var(--font-machine);
	font-size: var(--font-size-xs);
	color: var(--color-text-secondary);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	padding: var(--space-1) var(--space-2);
	cursor: pointer;
}

.code-language-select:focus {
	outline: none;
	border-color: var(--color-active);
}

.code-copy-btn {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 28px;
	height: 28px;
	background: transparent;
	border: none;
	color: var(--color-text-muted);
	cursor: pointer;
	border-radius: var(--radius-sm);
	transition: all var(--transition-fast);
}

.code-copy-btn:hover {
	background: var(--color-bg-hover);
	color: var(--color-text);
}

.code-container {
	position: relative;
}

.code-textarea {
	width: 100%;
	min-height: 36px;
	padding: var(--space-3);
	font-family: var(--font-mono);
	font-size: var(--font-size-sm);
	line-height: var(--line-height-relaxed);
	color: var(--color-text);
	background: var(--color-bg-sunken);
	border: none;
	resize: none;
	overflow: hidden;
	tab-size: 4;
}

.code-textarea:focus {
	outline: none;
}

/* Show textarea when editing, hide view */
.code-block.editing .code-textarea {
	position: relative;
	z-index: 1;
}

.code-block.editing .code-view {
	display: none;
}

/* Show view when not editing, hide textarea */
.code-block:not(.editing) .code-textarea {
	position: absolute;
	top: 0;
	left: 0;
	opacity: 0;
	pointer-events: none;
}

.code-block:not(.editing) .code-view {
	display: block;
}

.code-view {
	margin: 0;
	padding: var(--space-3);
	font-family: var(--font-mono);
	font-size: var(--font-size-sm);
	line-height: var(--line-height-relaxed);
	overflow-x: auto;
	cursor: text;
	background: var(--color-bg-sunken);
}

.code-view code {
	font-family: var(--font-mono);
	background: transparent;
}

/* Highlight.js theme overrides */
.code-view .hljs {
	background: transparent;
	padding: 0;
}

.mermaid-controls {
	display: flex;
	gap: var(--space-2);
	padding: var(--space-2) var(--space-3);
	background: var(--color-bg-sunken);
	border-top: 1px solid var(--color-border);
}

.mermaid-export-btn,
.mermaid-template {
	font-size: var(--font-size-xs);
	padding: var(--space-1) var(--space-2);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	cursor: pointer;
	color: var(--color-text);
}

.mermaid-export-btn:hover,
.mermaid-template:hover {
	background: var(--color-bg-hover);
}

/* Responsive Mermaid */
@media (max-width: 768px) {
	.mermaid-split {
		grid-template-columns: 1fr;
	}
}

/* ===========================================
   EDITOR TOOLS - Citation Block
   =========================================== */

.citation-block {
	display: inline;
}

.citation-display {
	display: inline;
	cursor: pointer;
}

.citation-key {
	color: var(--color-link);
	font-weight: 500;
}

.citation-preview {
	display: block;
	font-size: var(--font-size-sm);
	color: var(--color-text-muted);
	margin-top: var(--space-1);
}

.citation-placeholder {
	color: var(--color-text-muted);
	font-style: italic;
}

.citation-input-area {
	margin-top: var(--space-2);
	padding: var(--space-3);
	background: var(--color-bg-elevated);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
}

.citation-input-area label {
	display: block;
	font-size: var(--font-size-sm);
	color: var(--color-text-muted);
	margin-bottom: var(--space-1);
}

.citation-bibtex-input {
	width: 100%;
	min-height: 120px;
	padding: var(--space-2);
	font-family: var(--font-mono);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	resize: vertical;
	margin-bottom: var(--space-2);
}

.citation-bibtex-input:focus {
	outline: none;
	border-color: var(--color-link);
}

.citation-style-container {
	display: flex;
	align-items: center;
	gap: var(--space-2);
	margin-bottom: var(--space-2);
}

.citation-style-container label {
	margin-bottom: 0;
}

.citation-style-select {
	flex: 1;
	padding: var(--space-1) var(--space-2);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
}

.citation-parse-btn {
	width: 100%;
	padding: var(--space-2);
	font-size: var(--font-size-sm);
	font-weight: 500;
	color: var(--color-text-inverse);
	background: var(--color-accent);
	border: none;
	border-radius: var(--radius-sm);
	cursor: pointer;
}

.citation-parse-btn:hover {
	background: var(--color-accent-hover);
}

/* Inline citation in text */
.citation-inline {
	color: var(--color-link);
	cursor: pointer;
}

.citation-inline:hover {
	text-decoration: underline;
}

/* Bibliography styles */
.bibliography {
	margin-top: var(--space-8);
	padding-top: var(--space-4);
	border-top: 2px solid var(--color-border);
}

.bibliography-title {
	font-size: var(--font-size-xl);
	font-weight: 600;
	margin-bottom: var(--space-4);
}

.bibliography-entry {
	padding: var(--space-2) 0;
	padding-left: var(--space-6);
	text-indent: calc(-1 * var(--space-6));
	font-size: var(--font-size-sm);
	line-height: 1.6;
}

.bibliography-entry + .bibliography-entry {
	border-top: 1px solid var(--color-border-subtle);
}

/* ===========================================
   EDITOR TOOLS - Bibliography Block
   =========================================== */

.bibliography-block {
	margin: var(--space-6) 0;
	padding: var(--space-4);
	background: var(--color-bg-elevated);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
}

.bibliography-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: var(--space-3);
	margin-bottom: var(--space-4);
	padding-bottom: var(--space-3);
	border-bottom: 2px solid var(--color-border);
}

.bibliography-title-input {
	flex: 1;
	font-size: var(--font-size-xl);
	font-weight: 600;
	color: var(--color-text);
	background: transparent;
	border: none;
	padding: 0;
}

.bibliography-title-input:focus {
	outline: none;
}

.bibliography-style-container {
	display: flex;
	align-items: center;
	gap: var(--space-2);
	font-size: var(--font-size-sm);
	color: var(--color-text-muted);
}

.bibliography-style-select {
	padding: var(--space-1) var(--space-2);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
}

.bibliography-refresh-btn {
	padding: var(--space-1) var(--space-2);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	cursor: pointer;
}

.bibliography-refresh-btn:hover {
	background: var(--color-bg-hover);
}

.bibliography-content {
	font-size: var(--font-size-sm);
	line-height: 1.7;
}

.bibliography-content .csl-entry {
	padding: var(--space-2) 0;
	padding-left: var(--space-6);
	text-indent: calc(-1 * var(--space-6));
}

.bibliography-content .csl-entry + .csl-entry {
	border-top: 1px solid var(--color-border-subtle);
}

.bibliography-empty,
.bibliography-error {
	padding: var(--space-4);
	text-align: center;
	color: var(--color-text-muted);
}

.bibliography-hint {
	font-size: var(--font-size-xs);
	margin-top: var(--space-2);
}

/* ===========================================
   BibTeX Import Dialog
   =========================================== */

.bib-import-overlay {
	position: fixed;
	inset: 0;
	background: var(--color-bg-overlay);
	display: flex;
	align-items: center;
	justify-content: center;
	z-index: 1000;
	padding: var(--space-4);
}

.bib-import-dialog {
	width: 100%;
	max-width: 700px;
	max-height: 90vh;
	background: var(--color-bg);
	border-radius: var(--radius-lg);
	box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
	display: flex;
	flex-direction: column;
	overflow: hidden;
}

.bib-import-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: var(--space-4);
	border-bottom: 1px solid var(--color-border);
}

.bib-import-header h2 {
	margin: 0;
	font-size: var(--font-size-lg);
	font-weight: 600;
}

.bib-import-close {
	width: 32px;
	height: 32px;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: var(--font-size-xl);
	color: var(--color-text-muted);
	background: transparent;
	border: none;
	border-radius: var(--radius-sm);
	cursor: pointer;
}

.bib-import-close:hover {
	background: var(--color-bg-hover);
	color: var(--color-text);
}

.bib-import-body {
	flex: 1;
	overflow-y: auto;
	padding: var(--space-4);
}

.bib-import-tabs {
	display: flex;
	gap: var(--space-1);
	margin-bottom: var(--space-4);
	border-bottom: 1px solid var(--color-border);
}

.bib-import-tab {
	padding: var(--space-2) var(--space-3);
	font-size: var(--font-size-sm);
	color: var(--color-text-muted);
	background: transparent;
	border: none;
	border-bottom: 2px solid transparent;
	cursor: pointer;
	margin-bottom: -1px;
}

.bib-import-tab:hover {
	color: var(--color-text);
}

.bib-import-tab.active {
	color: var(--color-link);
	border-bottom-color: var(--color-link);
}

.bib-import-panel {
	display: none;
}

.bib-import-panel.active {
	display: block;
}

.bib-import-textarea {
	width: 100%;
	min-height: 200px;
	padding: var(--space-3);
	font-family: var(--font-mono);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg-sunken);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	resize: vertical;
}

.bib-import-textarea:focus {
	outline: none;
	border-color: var(--color-link);
}

.bib-import-dropzone {
	position: relative;
	padding: var(--space-8);
	border: 2px dashed var(--color-border);
	border-radius: var(--radius-md);
	text-align: center;
	cursor: pointer;
	transition: border-color 0.2s, background 0.2s;
}

.bib-import-dropzone:hover,
.bib-import-dropzone.dragover {
	border-color: var(--color-link);
	background: var(--color-bg-hover);
}

.bib-import-file-input {
	position: absolute;
	inset: 0;
	opacity: 0;
	cursor: pointer;
}

.bib-import-dropzone-icon {
	font-size: 2rem;
	display: block;
	margin-bottom: var(--space-2);
}

.bib-import-dropzone-content p {
	margin: 0;
	color: var(--color-text-muted);
}

.bib-import-file-info {
	margin-top: var(--space-2);
	font-size: var(--font-size-sm);
	color: var(--color-text-muted);
}

.bib-import-doi-input {
	width: 100%;
	padding: var(--space-3);
	font-size: var(--font-size-base);
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
}

.bib-import-doi-input:focus {
	outline: none;
	border-color: var(--color-link);
}

.bib-import-hint {
	margin-top: var(--space-2);
	font-size: var(--font-size-sm);
	color: var(--color-text-muted);
}

.bib-import-preview {
	margin-top: var(--space-4);
	padding-top: var(--space-4);
	border-top: 1px solid var(--color-border);
}

.bib-import-preview h3 {
	font-size: var(--font-size-sm);
	font-weight: 600;
	margin: 0 0 var(--space-2) 0;
	text-transform: uppercase;
	letter-spacing: 0.05em;
	color: var(--color-text-muted);
}

.bib-import-count {
	color: var(--color-link);
}

.bib-import-preview-list {
	max-height: 200px;
	overflow-y: auto;
}

.bib-import-preview-item {
	display: grid;
	grid-template-columns: auto 1fr auto auto;
	gap: var(--space-2);
	padding: var(--space-2);
	font-size: var(--font-size-sm);
	border-bottom: 1px solid var(--color-border-subtle);
}

.bib-import-preview-key {
	font-family: var(--font-mono);
	color: var(--color-link);
}

.bib-import-preview-title {
	font-weight: 500;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}

.bib-import-preview-authors {
	color: var(--color-text-muted);
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	max-width: 150px;
}

.bib-import-preview-year {
	color: var(--color-text-muted);
}

.bib-import-empty {
	padding: var(--space-4);
	text-align: center;
	color: var(--color-text-muted);
}

.bib-import-errors {
	margin-top: var(--space-4);
	padding: var(--space-3);
	background: rgba(220, 38, 38, 0.1);
	border-radius: var(--radius-md);
}

.bib-import-errors h3 {
	font-size: var(--font-size-sm);
	font-weight: 600;
	color: var(--color-error);
	margin: 0 0 var(--space-2) 0;
}

.bib-import-error-item {
	font-size: var(--font-size-sm);
	color: var(--color-error);
	padding: var(--space-1) 0;
}

.bib-import-footer {
	display: flex;
	justify-content: flex-end;
	gap: var(--space-2);
	padding: var(--space-4);
	border-top: 1px solid var(--color-border);
	background: var(--color-bg-elevated);
}

.bib-import-btn {
	padding: var(--space-2) var(--space-4);
	font-size: var(--font-size-sm);
	font-weight: 500;
	border-radius: var(--radius-sm);
	cursor: pointer;
	border: none;
}

.bib-import-btn-secondary {
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
}

.bib-import-btn-secondary:hover {
	background: var(--color-bg-hover);
}

.bib-import-btn-primary {
	color: var(--color-text-inverse);
	background: var(--color-accent);
}

.bib-import-btn-primary:hover:not(:disabled) {
	background: var(--color-accent-hover);
}

.bib-import-btn-primary:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}
/* ===========================================
   EDITOR.JS UI OVERRIDES
   =========================================== */

/* Plus button - hidden, use slash command instead */
.ce-toolbar__plus {
	display: none !important;
}

/* Toolbar actions (settings/move buttons) - show on block hover */
.ce-toolbar__actions {
	opacity: 0.3;
	transition: opacity var(--transition-fast);
}

.ce-block--focused .ce-toolbar__actions,
.ce-toolbar:hover .ce-toolbar__actions {
	opacity: 1;
}

/* Position toolbox (slash menu) */
.ce-toolbox {
	position: absolute !important;
	left: 0 !important;
	transform: translateX(0) !important;
	z-index: 1000 !important;
}

/* Slash menu (toolbox) - clean card style */
.ce-toolbox--opened {
	position: absolute !important;
	left: 0 !important;
	z-index: 1000 !important;
	display: flex !important;
	flex-direction: column !important;
	visibility: visible !important;
	opacity: 1 !important;
	min-width: 200px;
	max-width: 280px;
	max-height: 350px;
	overflow-y: auto;
	background: var(--color-bg-elevated);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	box-shadow: var(--shadow-lg);
	padding: var(--space-2);
}

/* Hide the default search input styling, restyle */
.ce-toolbox__search {
	padding: var(--space-2);
	margin-bottom: var(--space-2);
	border-bottom: 1px solid var(--color-border-subtle);
}

.ce-toolbox__search input {
	width: 100%;
	padding: var(--space-2) var(--space-3);
	font-family: var(--font-machine);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-sm);
	outline: none;
}

.ce-toolbox__search input:focus {
	border-color: var(--color-active);
}

.ce-toolbox__search input::placeholder {
	color: var(--color-text-muted);
}

/* Toolbox buttons - clean list style */
.ce-toolbox__button {
	display: flex !important;
	align-items: center;
	gap: var(--space-3);
	width: 100%;
	padding: var(--space-2) var(--space-3) !important;
	font-family: var(--font-machine);
	font-size: var(--font-size-sm);
	color: var(--color-text);
	background: transparent;
	border: none;
	border-radius: var(--radius-sm);
	cursor: pointer;
	text-align: left;
	transition: background var(--transition-fast);
}

.ce-toolbox__button:hover {
	background: var(--color-bg-hover);
}

.ce-toolbox__button--active {
	background: var(--color-bg-hover);
	color: var(--color-active);
}

/* Tool icon in toolbox */
.ce-toolbox__button svg {
	width: 20px;
	height: 20px;
	flex-shrink: 0;
	color: var(--color-text-secondary);
}

.ce-toolbox__button:hover svg,
.ce-toolbox__button--active svg {
	color: var(--color-text);
}

/* Tool name/title */
.ce-toolbox__button-title {
	flex: 1;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}

/* Settings gear button (block tune button) - visible on hover */
.ce-toolbar__settings-btn {
	display: flex !important;
	opacity: 0.4;
	transition: opacity var(--transition-fast);
}

.ce-toolbar__settings-btn:hover {
	opacity: 1;
}

/* Block settings popover */
.ce-popover {
	background: var(--color-bg-elevated) !important;
	border: 1px solid var(--color-border) !important;
	border-radius: var(--radius-lg) !important;
	box-shadow: var(--shadow-lg) !important;
	z-index: 1000 !important;
	min-width: 200px;
	max-width: 320px;
	padding: var(--space-2) !important;
}

/* Dark mode popover */
html.dark .ce-popover {
	background: #2a2a2a !important;
	border-color: #404040 !important;
}

/* Popover container - the wrapper */
.ce-popover__container {
	background: transparent !important;
	padding: 0 !important;
}

/* Popover items container */
.ce-popover__items {
	display: flex;
	flex-direction: column;
	gap: var(--space-1);
}

/* Popover search field */
.ce-popover__search {
	margin-bottom: var(--space-2);
}

.ce-popover__search input,
.cdx-search-field__input {
	width: 100%;
	padding: var(--space-2) var(--space-3) !important;
	font-family: var(--font-machine) !important;
	font-size: var(--font-size-sm) !important;
	color: var(--color-text) !important;
	background: var(--color-bg) !important;
	border: 1px solid var(--color-border) !important;
	border-radius: var(--radius-sm) !important;
	outline: none !important;
}

html.dark .ce-popover__search input,
html.dark .cdx-search-field__input {
	background: #1a1a1a !important;
	border-color: #404040 !important;
}

.ce-popover__search input:focus,
.cdx-search-field__input:focus {
	border-color: var(--color-active) !important;
}

/* Category labels (Basic, Advanced, etc.) */
.ce-popover__section-title,
.ce-popover-item-separator__line {
	font-family: var(--font-machine) !important;
	font-size: var(--font-size-xs) !important;
	font-weight: 600 !important;
	text-transform: uppercase !important;
	letter-spacing: var(--tracking-wider) !important;
	color: var(--color-text-muted) !important;
	padding: var(--space-2) var(--space-3) var(--space-1) !important;
	margin-top: var(--space-2) !important;
	border: none !important;
	background: transparent !important;
}

/* Popover item (tool button in slash menu) */
.ce-popover-item {
	display: flex !important;
	align-items: center !important;
	gap: var(--space-3) !important;
	width: 100% !important;
	padding: var(--space-2) var(--space-3) !important;
	font-family: var(--font-machine) !important;
	font-size: var(--font-size-sm) !important;
	color: var(--color-text) !important;
	background: transparent !important;
	border: none !important;
	border-radius: var(--radius-sm) !important;
	cursor: pointer !important;
	text-align: left !important;
	transition: background var(--transition-fast) !important;
}

.ce-popover-item:hover {
	background: var(--color-bg-hover) !important;
}

html.dark .ce-popover-item:hover {
	background: #333 !important;
}

.ce-popover-item--focused {
	background: var(--color-bg-hover) !important;
}

html.dark .ce-popover-item--focused {
	background: #333 !important;
}

/* Tool icon container */
.ce-popover-item__icon {
	display: flex !important;
	align-items: center !important;
	justify-content: center !important;
	width: 28px !important;
	height: 28px !important;
	flex-shrink: 0 !important;
	background: var(--color-bg-sunken) !important;
	border-radius: var(--radius-sm) !important;
}

html.dark .ce-popover-item__icon {
	background: #1a1a1a !important;
}

.ce-popover-item__icon svg {
	width: 18px !important;
	height: 18px !important;
	color: var(--color-text-secondary) !important;
}

.ce-popover-item:hover .ce-popover-item__icon svg {
	color: var(--color-text) !important;
}

/* Tool title and description */
.ce-popover-item__title {
	font-weight: 500 !important;
	color: var(--color-text) !important;
	flex: 1 !important;
}

.ce-popover-item__secondary-title {
	font-family: var(--font-machine) !important;
	font-size: var(--font-size-xs) !important;
	color: var(--color-text-muted) !important;
	margin-top: 2px !important;
}

/* Nothing found message */
.ce-popover__nothing-found-message {
	font-family: var(--font-machine) !important;
	font-size: var(--font-size-sm) !important;
	color: var(--color-text-muted) !important;
	text-align: center !important;
	padding: var(--space-4) !important;
}

/* Deprecated: Old popover item styling (for compatibility) */
.ce-popover__item {
	color: var(--color-text);
}

.ce-popover__item:hover {
	background: var(--color-bg-hover);
}

/* DragDrop handles - from editorjs-drag-drop */
.ce-block__content {
	position: relative;
}

/* Active/focused block indicator - thin accent line on left */
.ce-block--focused .ce-block__content::before,
.ce-block--selected .ce-block__content::before {
	content: '';
	position: absolute;
	top: 0;
	bottom: 0;
	left: -12px;
	width: 2px;
	background: var(--color-active);
	border-radius: 1px;
}

/* Drop target indicator - thin accent line between blocks */
.ce-block--drop-target .ce-block__content::after {
	content: '';
	position: absolute;
	top: -2px;
	left: 0;
	right: 0;
	height: 2px;
	background: var(--color-active);
	border-radius: 1px;
}

/* Remove any black borders or outlines from blocks */
.ce-block,
.ce-block__content,
.ce-block--focused,
.ce-block--selected,
.ce-block--dragging,
.ce-paragraph,
.ce-block [contenteditable],
.ce-block [contenteditable]:focus,
.ce-block [contenteditable]:focus-visible,
.codex-editor__redactor {
	border: none !important;
	outline: none !important;
	box-shadow: none !important;
}

/* Also target any nested elements */
.ce-block * {
	outline: none !important;
}

.ce-block--dragging {
	opacity: 0.5;
	cursor: grabbing;
}

/* Drag handle - no tooltip/popup */
.ce-toolbar__actions [data-tooltip]::before,
.ce-toolbar__actions [data-tooltip]::after {
	display: none !important;
}

/* Drag handle visibility - ensure contrast in light mode */
.ce-toolbar__actions .ce-toolbar__actions-buttons {
	opacity: 0.7;
}

.ce-toolbar__actions .ce-toolbar__settings-btn,
.ce-toolbar__actions button[data-tool="move-up"],
.ce-toolbar__actions button[data-tool="move-down"] {
	color: var(--color-text-secondary);
}

html:not(.dark) .ce-toolbar__actions {
	opacity: 0.6;
}

html:not(.dark) .ce-block:hover .ce-toolbar__actions {
	opacity: 1;
}

/* Block tune wrapper (settings menu) */
.ce-settings {
	background: var(--color-bg-elevated);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	box-shadow: var(--shadow-lg);
}

.ce-settings__button {
	color: var(--color-text);
}

.ce-settings__button:hover {
	background: var(--color-bg-hover);
}

.ce-settings__button--delete:hover {
	color: var(--color-error);
}

/* Inline toolbar styling */
.ce-inline-toolbar {
	background: var(--color-bg-elevated);
	border: 1px solid var(--color-border);
	border-radius: var(--radius-md);
	box-shadow: var(--shadow-md);
}

.ce-inline-tool {
	color: var(--color-text);
}

.ce-inline-tool:hover {
	background: var(--color-bg-hover);
}

.ce-inline-tool--active {
	color: var(--color-active);
}